
<!DOCTYPE HTML>
<html lang="en" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Parsing and Writing JSON Â· Effective Software Testing</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="Ham Vocke">
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="ui-tests.html" />
    
    
    <link rel="prev" href="third-party-integration-tests.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Effective Software Testing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="importance-of-automation.html">
            
                <a href="importance-of-automation.html">
            
                    
                    The Importance of (Test) Automation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="tools-and-libraries.html">
            
                <a href="tools-and-libraries.html">
            
                    
                    Tools and Libraries We'll Look At
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="sample-application.html">
            
                <a href="sample-application.html">
            
                    
                    The Sample Application
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="unit-tests.html">
            
                <a href="unit-tests.html">
            
                    
                    Unit Tests
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="test-structure.html">
            
                <a href="test-structure.html">
            
                    
                    Test Structure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="unit-test-example.html">
            
                <a href="unit-test-example.html">
            
                    
                    Implementing a Unit Test
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="integration-tests.html">
            
                <a href="integration-tests.html">
            
                    
                    Integration Tests
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="database-integration-tests.html">
            
                <a href="database-integration-tests.html">
            
                    
                    Database Integration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="rest-api-integration-tests.html">
            
                <a href="rest-api-integration-tests.html">
            
                    
                    REST API Integration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="third-party-integration-tests.html">
            
                <a href="third-party-integration-tests.html">
            
                    
                    Integration With Third-Party Services
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.6.4" data-path="json-parsing-integration-tests.html">
            
                <a href="json-parsing-integration-tests.html">
            
                    
                    Parsing and Writing JSON
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="ui-tests.html">
            
                <a href="ui-tests.html">
            
                    
                    UI Tests
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="contract-tests.html">
            
                <a href="contract-tests.html">
            
                    
                    Contract Tests
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="consumer-test.html">
            
                <a href="consumer-test.html">
            
                    
                    Consumer Test
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="provider-test.html">
            
                <a href="provider-test.html">
            
                    
                    Provider Test
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="end-to-end-tests.html">
            
                <a href="end-to-end-tests.html">
            
                    
                    End-to-End Tests
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="ui-e2e-test.html">
            
                <a href="ui-e2e-test.html">
            
                    
                    Testing via the Web Interface
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="rest-api-e2e-test.html">
            
                <a href="rest-api-e2e-test.html">
            
                    
                    Testing via the REST API
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="acceptance-tests.html">
            
                <a href="acceptance-tests.html">
            
                    
                    Acceptance Tests
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="exploratory-testing.html">
            
                <a href="exploratory-testing.html">
            
                    
                    Exploratory Testing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="avoid-test-duplication.html">
            
                <a href="avoid-test-duplication.html">
            
                    
                    Avoid Test Duplication
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="conclusion.html">
            
                <a href="conclusion.html">
            
                    
                    Conclusion
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="further-reading.html">
            
                <a href="further-reading.html">
            
                    
                    Further Reading
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Parsing and Writing JSON</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="parsing-and-writing-json">Parsing and Writing JSON</h1>
<p>Writing a REST API these days you often pick JSON when it comes to sending your data over the wire. Using Spring there&apos;s no need to writing JSON by hand nor to write logic that transforms your objects into JSON (although you can do both if you feel like reinventing the wheel). Defining <abbr title="Plain Old Java Object">POJOs</abbr> that represent the JSON structure you want to parse from a request or send with a response is enough.</p>
<p>Spring and <a href="https://github.com/FasterXML/jackson" target="_blank">Jackson</a> take care of everything else. With the help of Jackson, Spring automagically parses JSON into Java objects and vice versa. If you have good reasons you can use any other JSON mapper out there in your codebase. The advantage of Jackson is that it comes bundled with Spring Boot.</p>
<p>Spring often hides the parsing and converting to JSON part from you as a developer. If you define a method in a <code>RestController</code> that returns a POJO, Spring MVC will automatically convert that POJO to a JSON string and put it in the response body. With Spring&apos;s <code>RestTemplate</code> you get the same magic. Sending a request using <code>RestTemplate</code> you can provide a POJO class that should be used to parse the response. Again it&apos;s Jackson being used under the hood.</p>
<p>When we talk to the weather API we receive a JSON response. The <code>WeatherResponse</code> class is a POJO representation of that JSON structure including all the fields we care about (which is only <code>response.currently.summary</code>). Using the <code>@JsonIgnoreProperties</code> annotation with the <code>ignoreUnknown</code> parameter set to <code>true</code> on our POJO objects gives us a <a href="https://www.martinfowler.com/bliki/TolerantReader.html" target="_blank">tolerant reader</a>, an interface that is liberal in what data it accepts (following <a href="https://en.wikipedia.org/wiki/Robustness_principle" target="_blank">Postel&apos;s Law</a>). This way there can be all kinds of silly stuff in the JSON response we receive from the weather API. As long as <code>response.currently.summary</code> is there, we&apos;re happy.</p>
<p>If you want to test-drive your Jackson Mapping take a look at the <code>WeatherResponseTest</code>. This one tests the conversion of JSON into a <code>WeatherResponse</code> object. Since this deserialization is the only conversion we do in the application there&apos;s no need to test if a <code>WeatherResponse</code> can be converted to JSON correctly. Using the approach outlined below it&apos;s very simple to test serialization as well, though.</p>
<pre><code class="lang-java"><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">shouldDeserializeJson</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
   String jsonResponse = FileLoader.read(<span class="hljs-string">&quot;classpath:weatherApiResponse.json&quot;</span>);
   WeatherResponse expectedResponse = <span class="hljs-keyword">new</span> WeatherResponse(<span class="hljs-string">&quot;Rain&quot;</span>);

   WeatherResponse parsedResponse = <span class="hljs-keyword">new</span> ObjectMapper().readValue(jsonResponse, WeatherResponse.class);

   assertThat(parsedResponse, is(expectedResponse));
}
</code></pre>
<p>In this test case I read a sample JSON response from a file and let Jackson parse this JSON response using <code>ObjectMapper.readValue()</code>. Then I compare the result of the conversion with an expected <code>WeatherResponse</code> to see if the conversion works as expected.</p>
<p>You can argue that this kind of test is rather a unit than an integration test. Nevertheless, this kind of test can be pretty valuable to make sure that your JSON serialization and deserialization works as expected. Having these tests in place allows you to keep the integration tests around your REST API and your client classes smaller as you don&apos;t need to check the entire JSON conversion again.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="third-party-integration-tests.html" class="navigation navigation-prev " aria-label="Previous page: Integration With Third-Party Services">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="ui-tests.html" class="navigation navigation-next " aria-label="Next page: UI Tests">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Parsing and Writing JSON","level":"1.6.4","depth":2,"next":{"title":"UI Tests","level":"1.7","depth":1,"path":"ui-tests.md","ref":"ui-tests.md","articles":[]},"previous":{"title":"Integration With Third-Party Services","level":"1.6.3","depth":2,"path":"third-party-integration-tests.md","ref":"third-party-integration-tests.md","articles":[]},"dir":"ltr"},"config":{"plugins":[],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"Ham Vocke","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Effective Software Testing","language":"en","gitbook":"*"},"file":{"path":"json-parsing-integration-tests.md","mtime":"2017-11-25T11:11:16.577Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2017-11-25T11:59:56.755Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

